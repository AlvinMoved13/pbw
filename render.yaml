services:
# MySQL Database
- type: pserv
  name: pbw-mysql
  env: docker
  plan: free
  dockerfilePath: ./Dockerfile.mysql
  disk:
    name: mysql-data
    mountPath: /var/lib/mysql
    sizeGB: 1
  envVars:
  - key: MYSQL_ROOT_PASSWORD
    generateValue: true
  - key: MYSQL_DATABASE
    value: railway

# PHP Web Application
- type: web
  name: pbw
  env: docker
  plan: free
  dockerfilePath: ./Dockerfile
  envVars:
  - key: MYSQLHOST
    fromService:
      name: pbw-mysql
      type: pserv
      property: host
  - key: MYSQLPORT
    value: 3306
  - key: MYSQLUSER
    value: root
  - key: MYSQLPASSWORD
    fromService:
      name: pbw-mysql
      type: pserv
      envVarKey: MYSQL_ROOT_PASSWORD
  - key: MYSQLDATABASE
    value: railway
